\def\module{M4P32 Number Theory: Elliptic Curves}
\def\lecturer{Prof Toby Gee}
\def\term{Autumn 2019}
\def\cover{}
\def\syllabus{}
\def\thm{section}

\input{../style/header}

\begin{document}

\input{../style/main}

\setcounter{section}{0}

\section{Introduction}

\lecture{1}{Thursday}{03/10/19}

The following are books.
\begin{itemize}
\item J W S Cassels, Lectures on elliptic curves, 1991
\item J H Silverman, The arithmetic of elliptic curves, 1986
\item J H Silverman and J Tate, Rational points on elliptic curves, 1992
\end{itemize}
Note that there are a lot of books on elliptic curves out there, and a lot of them are not relevant to this course, so either different topics, or they will be too advanced. Also, about half of this course will not actually be on elliptic curves. We are going to start off by looking at conics, which are simpler but are a good place to start in order to build intuition and technique. As explained below, we will be essentially following Cassels, although there is quite a lot of material that we will not cover, and our treatment of a $ 2 $-descent, that is our method for computing the rank of an elliptic curve over $ \QQ $, will be different. The overall aim of this course is to learn more about solving polynomial equations in $ \ZZ $ or $ \QQ $. For example,
$$ x^2 + y^2 = 5, \qquad y^2 = x^3 - x, \qquad x^4 + y^4 = 17. $$
Let $ k $ be a field, such as $ \QQ $, $ \RR $, $ \CC $, the field of $ p $ elements $ \FF_p $, or the $ p $-adic numbers $ \QQ_p $, and let its polynomial ring be $ k\sbr{x_0, \dots, x_n} $. A \textbf{monomial} is a term $ x_0^{a_0}\dots x_n^{a_n} $, which has degree $ a_0 + \dots + a_n $. The \textbf{degree} of a polynomial is the maximal degree of a monomial occuring in it.

\begin{example*}
$ x_1^5 + x_2x_3 + x_{10}x_{11}^5 $ has degree six.
\end{example*}

Equations in one variable are easy to solve over $ \QQ $.

\begin{example*}
Let $ 3x^5 - 9x^3 + x^2 + \tfrac{148}{81} = 0 $, so $ 243x^5 - 729x^3 + 81x^2 + 148 = 0 $. If $ x = a / b $ with $ \br{a, b} = 1 $, we need $ 243a^5 - 729a^3b^2 + 81a^2b^3 + 148b^5 = 0 $. Then $ b \ne 0 $, so $ a \ne 0 $, so $ a^2 \mid 148 $, so $ a \mid 2 $, so $ a = \pm 1, \pm 2 $. Similarly $ b^2 \mid 243 $, so $ b \mid 9 $, so $ b = \pm 1, \pm 3, \pm 9 $. Check each of these, and $ x = \tfrac{2}{3} $.
\end{example*}

More than two variables, over $ \QQ $, is hopeless, so let $ x $ and $ y $ be two variables.
\begin{itemize}
\item Degree one is very easy, since $ ax + by + c = 0 $ for $ b \ne 0 $ gives $ y = -c / b - \br{a / b}x $.
\item Degree two and three are in this course.
\item Degree four can be reduced to degree three.
\end{itemize}

\begin{theorem}[Mordell's conjecture and Falting's theorem]
A general equation in two variables of degree greater than four has only finitely many solutions over $ \QQ $.
\end{theorem}

General equations are nonsingular, so $ \br{x - y}\br{x^{100} + 10y + 1} = 0 $ and $ x^{73} - y^{109} = 0 $ are not general.

\begin{example}
Let $ x^2 + y^2 = c $ for $ c \in \QQ $.
\begin{itemize}
\item $ x^2 + y^2 = -1 $ has no solutions in $ \RR $.
\item $ x^2 + y^2 = 0 $ has $ \br{x, y} = \br{0, 0} $ in $ \RR $.
\item $ x^2 + y^2 = 1 $ has infinitely many solutions $ \br{x, y} = \br{\tfrac{3}{5}, \tfrac{4}{5}}, \br{\tfrac{5}{13}, \tfrac{12}{13}}, \dots $, since $ \br{a / c}^2 + \br{b / c}^2 = 1 $ gives $ a^2 + b^2 = c^2 $, which has infinitely many solutions $ \br{3, 4, 5}, \br{5, 12, 13}, \dots $.
\item $ x^2 + y^2 = 3 $ has no solutions in $ \QQ $, since $ a^2 + b^2 = 3c^2 $ has no solutions for $ a, b, c \in \ZZ $ and $ c \ne 0 $. Suppose $ a, b, c $ is such a solution. Then $ a^2 + b^2 \equiv 0 \mod 3 $. But all squares are $ 0 $ or $ 1 $ modulo $ 3 $, so $ a \equiv b \equiv 0 \mod 3 $. Write $ a = 3A $ and $ b = 3B $ gives $ 3\br{A^2 + B^2} = c^2 $, so $ 3 \mid c $. Write $ c = 3C $ gives $ A^2 + B^2 = 3C^2 $, a contradiction, by induction on the biggest power of $ 3 $ dividing $ c $. Next week $ x^2 + y^2 = 3 $ has no solutions in $ \QQ_3 $.
\end{itemize}
\end{example}

\begin{example}
$ x^2 + 2y^2 = 6 $ has $ \br{x, y} = \br{2, 1} $, which has line $ y - 1 = m\br{x - 2} $, so
$$ \br{2m\br{x - 2}}^2 + x^2 - 6 = 0 \qquad \implies \qquad \br{2m^2 + 1}x^2 + \br{4m - 8m^2}x + 2\br{1 - 2m}^2 - 6 = 0. $$
The sum of the roots of $ ax^2 + bx + c $ is $ -b / a $. So the second root, other than $ x = 2 $ and $ y = 1 $, is
$$ x = \dfrac{8m^2 - 4m}{2m^2 + 1} - 2 = \dfrac{4m^2 - 4m - 2}{2m^2 + 1}, \qquad y = \dfrac{-2m^2 - 4m + 1}{2m^2 + 1}. $$
\end{example}

\pagebreak

\section{The \texorpdfstring{$ p $}{p}-adic numbers}

\lecture{2}{Monday}{07/10/19}

\begin{definition}
A \textbf{norm} on a field $ k $ is a function $ \abs{\cdot} : k \to \RR $ such that
\begin{enumerate}
\item $ \abs{x} \ge 0 $ with equality if and only if $ x = 0 $,
\item $ \abs{xy} = \abs{x} \cdot \abs{y} $, and
\item $ \abs{x + y} \le \abs{x} + \abs{y} $.
\end{enumerate}
\end{definition}

$ 2 $ implies that $ \abs{1} = \abs{-1} = 1 $. So $ \abs{x} = \abs{-x} $.

\begin{example*}
Usual absolute value on $ \RR $, that is
$$ \abs{x} =
\begin{cases}
x & x \ge 0 \\
-x & x < 0 \\
\end{cases}.
$$
\end{example*}

\begin{remark}
Define
$$ \function[d\br{\cdot, \cdot}]{k^2}{\RR}{\br{x, y}}{\abs{x - y}}, $$
then $ d $ is a metric on $ k^2 $. Not every metric comes from a norm.
\end{remark}

\begin{definition}
Let $ k = \QQ $. Then the \textbf{$ p $-adic norm} is defined by
$$
\function[\abs{\cdot}_p]{\QQ}{\RR}{x}{
\begin{cases}
0 & x = 0 \\
p^{-n} & x = p^n\dfrac{a}{b}, \ n \in \ZZ, \ \br{p, a} = \br{p, b} = \br{a, b} = 1
\end{cases}
}.
$$
\end{definition}

\begin{lemma}
$ \abs{\cdot}_p $ is a norm, and in fact
\begin{enumerate}
\item[$ 3^* $.] $ \abs{x + y} \le \max\br{\abs{x}, \abs{y}} $.
\end{enumerate}
\end{lemma}

\begin{proof}
Without loss of generality, $ x, y \in \ZZ $. Also we may assume $ x, y, x + y \ne 0 $. Then $ 3^* $ is equivalent to, if $ p^n \mid x $ and $ p^n \mid y $, then $ p^n \mid \br{x + y} $.
\end{proof}

\begin{definition}
We say that $ 3^* $ is the \textbf{ultrametric inequality}. If $ \abs{\cdot} $ satisfies $ 3^* $, we say that $ \abs{\cdot} $ is \textbf{non-archimedean}.
\end{definition}

We have infinitely many norms on $ \QQ $, the one from $ \RR $, and the $ p $-adic norm $ \abs{\cdot}_p $ for each prime $ p $. Say that two norms $ \abs{\cdot}_1 $ and $ \abs{\cdot}_2 $ on $ k $ are \textbf{equivalent} if there exists $ \alpha > 0 $ such that $ \abs{\cdot}_1 = \abs{\cdot}_2^\alpha $.

\begin{exercise*}
Check two norms are equivalent if and only if the corresponding metrics give the same topology on $ k $.
\end{exercise*}

\begin{theorem}
Any norm on $ \QQ $ is equivalent to exactly one of
\begin{itemize}
\item the archimedean norm coming from $ \RR $,
\item a norm $ \abs{\cdot}_p $ for some uniquely determined $ p $, or
\item the discrete norm $ \abs{x} = 1 $ if $ x \ne 0 $.
\end{itemize}
\end{theorem}

\begin{lemma}
\label{lem:2.7}
If $ \abs{\cdot} $ is non-archimedean and $ \abs{x} \ne \abs{y} $, then $ \abs{x + y} = \max\br{\abs{x}, \abs{y}} $.
\end{lemma}

\begin{proof}
Without loss of generality $ \abs{x} > \abs{y} $. Write $ x = \br{x + y} + \br{-y} $, so that $ 3^* $ gives us
$$ \abs{x} \le \max\br{\abs{x + y}, \abs{-y}} \le \max\br{\abs{x}, \abs{y}, \abs{-y}} = \abs{x}. $$
So $ \abs{x} = \max\br{\abs{x + y}, \abs{y}} $. But $ \abs{x} > \abs{-y} = \abs{y} $, so $ \abs{x} = \abs{x + y} $.
\end{proof}

\begin{exercise}
Check Lemma \ref{lem:2.7} for $ \abs{\cdot}_p $ using the definition.
\end{exercise}

\pagebreak

Recall that
\begin{itemize}
\item a sequence $ \br{x_n} $ in $ k $ is \textbf{Cauchy} if for all $ \epsilon > 0 $ there exists $ N $ such that $ m, n \ge N $ implies that $ \abs{x_m - x_n} < \epsilon $, and
\item a sequence $ \br{x_n} $ \textbf{converges} to $ x \in k $ if for all $ \epsilon > 0 $ there exists $ M $ such that $ n \ge M $ implies that $ \abs{x_n - x} < \epsilon $.
\end{itemize}
$ \br{x_n} $ converges implies that $ \br{x_n} $ is Cauchy, but in general $ \br{x_n} $ is Cauchy does not imply that $ \br{x_n} $ converges.

\begin{example*}
\hfill
\begin{itemize}
\item $ \RR $ is complete.
\item $ \QQ $ is not complete with respect to the usual archimedean norm. For example, $ 3, 3.1, \dots \to \pi \notin \QQ $.
\end{itemize}
\end{example*}

\begin{example}
Let $ p = 2 $. Then $ \br{x_n} = 3, 33, \dots $ is Cauchy with respect to $ \abs{\cdot}_2 $, and $ x_n = \tfrac{10^n - 1}{3} \to -\tfrac{1}{3} $ as $ n \to \infty $ because $ \abs{x_n + \tfrac{1}{3}}_2 = \abs{\tfrac{10^n}{3}}_2 = \abs{2^n\tfrac{5^n}{3}} = 2^{-n} \to 0 $.
\end{example}

\begin{example}
Let $ x_n = 5^{2^n} $. If $ p = 5 $, then $ x_n \to 0 $, since $ \abs{5^{2^n}}_5 = 5^{-2^n} \to 0 $ as $ n \to \infty $. If $ p = 2 $, then $ x_n \to 1 $ as $ n \to \infty $, since $ \br{1 + y}^2 = 1 + 2y + y^2 $. \footnote{Exercise}
\end{example}

\begin{example*}
A Cauchy sequence in $ \QQ $ for $ \abs{\cdot}_3 $ which does not converge. Take a sequence converging to $ \sqrt{7} $. That is, take $ \br{x_n} $ such that $ x_n^2 - 7 \to 0 $, that is $ \abs{x_n^2 - 7}_3 \to 0 $ as $ n \to \infty $. For example, take $ x_n \in \ZZ $, chosen such that $ x_n^2 \equiv 7 \mod 3^n $. For example,
$$ x_1 = 1, \qquad x_2 = 4, \qquad x_3 = 13, \qquad \dots. $$
\end{example*}

\begin{exercise}
If $ p > 2 $ and $ t \in \ZZ $ is not a square but is a quadratic residue modulo $ p $, that is there exists $ y $ such that $ y^2 \equiv t \mod p $, then there exists a Cauchy sequence $ \br{x_n} $ in $ \QQ $ with $ x_n^2 \to t $ as $ n \to \infty $, such as $ t = 1 - p $. If $ p = 2 $, then $ t = -7 $ works.
\end{exercise}

\lecture{3}{Tuesday}{08/10/19}

$ \QQ $ is not complete with respect to any $ \abs{\cdot}_p $. Let $ k $ be a field and $ \abs{\cdot} $ be non-archimedean. Let
$$ R = \cbr{\text{Cauchy sequences in} \ k}, $$
where $ \br{x_n} + \br{y_n} = \br{x_n + y_n} $ and $ \br{x_n}\br{y_n} = \br{x_ny_n} $. Let
$$ I = \cbr{\br{x_n} \st x_n \to 0 \ \text{as} \ n \to \infty}. $$

\begin{exercise*}
\hfill
\begin{itemize}
\item Check that $ I $ is an ideal in $ R $.
\item If $ \br{x_n} \notin I $, then there exists $ N $ such that $ n \ge N $ implies that $ x_n \ne 0 $. Show that furthermore the sequence $ \br{y_n} $ defined by
$$ y_n =
\begin{cases}
0 & n < N \\
\dfrac{1}{x_n} & n \ge N
\end{cases}
$$
is Cauchy, and $ x_ny_n = 1 $ for all $ n \ge N $, so $ \br{x_n}\br{y_n} - 1 \in I $.
\end{itemize}
\end{exercise*}

That is, $ I $ is a maximal ideal of $ R $, so $ \widehat{k} = R / I $ is a field. There is a natural map
$$ \function{k}{\widehat{k}}{x}{\br{x}_{n \ge 1}}. $$
This is an injection. Call $ \widehat{k} $ the \textbf{completion} of $ k $. The norm $ \abs{\cdot} $ extends to $ \widehat{k} $ by defining
$$ \abs{\br{x_n}} = \lim_{n \to \infty} \abs{x_n}. $$

\begin{exercise*}
\hfill
\begin{itemize}
\item Check that this is defined, and is a norm.
\item Check that if $ x_n \not\to 0 $, then $ \abs{x_n} $ is eventually constant, by using Lemma \ref{lem:2.7}.
\end{itemize}
\end{exercise*}

\pagebreak

\begin{lemma}
\label{lem:2.12}
$ k $ is dense in $ \widehat{k} $.
\end{lemma}

\begin{proof}
Need to show that if $ x \in \widehat{k} $ and $ \epsilon > 0 $, then there exists $ y \in k $ such that $ \abs{x - y} < \epsilon $. Write $ x = \br{x_n} $ for $ x_n \in k $, and choose $ N $ such that if $ m, n \ge N $, then $ \abs{x_m - x_n} < \epsilon $. Then take $ y = x_N $. Then $ \abs{x - y} = \lim_{n \to \infty} \abs{x_n - x_N} < \epsilon $.
\end{proof}

\begin{lemma}
$ \widehat{k} $ is complete.
\end{lemma}

\begin{proof}
Let $ \br{x_n} $ be a Cauchy sequence in $ \widehat{k} $, so $ x_n $ is itself an equivalence class of Cauchy sequences in $ k $. By Lemma \ref{lem:2.12}, for each $ n \ge 1 $ there exists $ y_n \in k $ such that $ \abs{x_n - y_n} < \tfrac{1}{n} $. Claim that $ y = \br{y_n} $ is a Cauchy sequence, and $ x_n \to y $ as $ n \to \infty $. Since
$$ \abs{y_m - y_n} \le \abs{y_m - x_m} + \abs{x_m - x_n} + \abs{x_n - y_n} < \dfrac{1}{m} + \dfrac{1}{n} + \abs{x_m - x_n}, $$
and $ \br{x_n} $ is Cauchy, so $ \br{y_n} $ is Cauchy. Then
$$ \abs{x_n - y} \le \abs{x_n - y_n} + \abs{y_n - y} < \dfrac{1}{n} + \abs{y_n - y}. $$
Need to check that $ \abs{y_n - y} \to 0 $ as $ n \to \infty $, which is what we did in the proof of Lemma \ref{lem:2.12}.
\end{proof}

\begin{definition}
Let $ k = \QQ $ and $ \abs{\cdot} = \abs{\cdot}_p $. Write the field of \textbf{$ p $-adic numbers} $ \QQ_p $ for $ \widehat{k} $, the completion of $ \QQ $ with respect to $ \abs{\cdot}_p $, and the ring of \textbf{$ p $-adic integers}
$$ \ZZ_p = \cbr{x \in \QQ_p \st \abs{x}_p \le 1} \subset \QQ_p. $$
\end{definition}

By construction or definition, $ \QQ \subset \QQ_p $, and $ \ZZ \subset \ZZ_p $.

\begin{exercise}
Show that $ \ZZ_p $ is a subring of $ \QQ_p $. More generally, if $ k $ is any non-archimedean field, then
$$ \cbr{x \in k \st \abs{x} \le 1} $$
is a subring of $ k $.
\end{exercise}

\begin{note*}
$ \tfrac{1}{p} \notin \ZZ_p $, and $ \abs{\tfrac{1}{p}}_p = p > 1 $. In fact $ \QQ_p = \ZZ_p\sbr{\tfrac{1}{p}} $, the field of fractions of $ \ZZ_p $.
\end{note*}

\begin{definition}
If $ k $ is any field with a norm $ \abs{\cdot} $, then we write
$$ \sum_{n = 1}^\infty a_n = \lim_{m \to \infty} \sum_{n = 1}^m a_n, $$
if this limit exists.
\end{definition}

\begin{lemma}
\label{lem:2.17}
If $ k $ is non-archimedean, and $ t_1, \dots, t_n \in k $, then
$$ \abs{\sum_{i = 1}^n t_i} \le \max_{1 \le i \le n} t_i. $$
In particular if $ \abs{t_i} \le R $ for all $ i $, then $ \abs{\sum_{i = 1}^n t_i} \le R $.
\end{lemma}

\begin{proof}
Induction on $ n $, where $ n = 2 $ is $ 3^* $.
\end{proof}

\begin{corollary}
\label{cor:2.18}
A sequence $ \br{t_n} $ is Cauchy if and only if $ \abs{t_n - t_{n + 1}} \to 0 $ as $ n \to \infty $.
\end{corollary}

\begin{proof}
If $ m > n $, then
$$ t_m - t_n = \br{t_m - t_{m - 1}} + \dots + \br{t_{n + 1} - t_n}, $$
and use Lemma \ref{lem:2.17}.
\end{proof}

\pagebreak

\begin{lemma}
If $ k $ is complete non-archimedean, such as $ k = \QQ_p $, then $ \sum_{n = 1}^\infty x_n $ converges if and only if $ x_n \to 0 $ as $ n \to \infty $. If $ \abs{x_n} \le R $ and $ x_n \to 0 $ then $ \abs{\sum_{n = 1}^\infty x_n} \le R $.
\end{lemma}

\begin{proof}
$ \sum_{n = 1}^\infty x_n $ converges if and only if $ \br{\sum_{n = 1}^m x_n}_{m \ge 1} $ converges. Since $ k $ is complete, this is if and only if $ \br{\sum_{n = 1}^m x_n}_{m \ge 1} $ is Cauchy. By Corollary \ref{cor:2.18}, this is if and only if $ x_{m + 1} \to 0 $. The final statement then follows from Lemma \ref{lem:2.17}.
\end{proof}

\begin{lemma}
\label{lem:2.20}
If $ a_n \in \ZZ $ then $ \sum_{n = 0}^\infty a_np^n $ converges in $ \QQ_p $. If $ a_n = 0 $ for $ n < T $ and $ a_T \ne 0 $, and $ p \nmid a_T $, then $ \abs{\sum_{n = 0}^\infty a_np^n}_p = p^{-T} $.
\end{lemma}

\begin{proof}
Since $ a_n \in \ZZ $,
$$ \abs{a_np^n}_p = \abs{a_n}_p \cdot \abs{p^n}_p \le \abs{p^n}_p = p^{-n} \to 0. $$
Furthermore $ \abs{a_Tp^T}_p = p^{-T} $ and $ \abs{a_np^n}_p \le p^{-T - 1} $ if $ n \ge T + 1 $, so $ \abs{\sum_{n = T + 1}^\infty a_np^n}_p \le p^{-T - 1} $, so
$$ \abs{a_Tp^T + \sum_{n = T + 1}^\infty a_np^n}_p = p^{-T}, $$
by Lemma \ref{lem:2.7}.
\end{proof}

\lecture{4}{Thursday}{10/10/19}

\begin{proposition}
\label{prop:2.21}
\hfill
\begin{enumerate}
\item If $ a_n \in \cbr{0, \dots, p - 1} $, then $ \sum_n a_np^n $ converges to an element of $ \ZZ_p $. Furthermore if
$$ \sum_n a_np^n = \sum_n b_np^n, \qquad b_n \in \cbr{0, \dots, p - 1}, $$
then $ a_n = b_n $ for all $ n $.
\item If $ \alpha \in \ZZ_p $ then there exists $ \br{a_n} $ as in $ 1 $ such that $ \alpha = \sum_n a_np^n $.
\end{enumerate}
\end{proposition}

\begin{proof}
\hfill
\begin{enumerate}
\item Lemma \ref{lem:2.20} gives convergence. Suppose that $ T $ is minimal such that $ a_T \ne b_T $, then by Lemma \ref{lem:2.20}, $ \abs{\sum_n \br{a_n - b_n}p^n}_p = p^{-T} $. In particular $ \sum_n \br{a_n - b_n}p^n \ne 0 $.
\item By construction, $ \QQ $ is dense in $ \QQ_p $. So there exists $ \beta \in \QQ $ such that $ \abs{\alpha - \beta}_p < 1 $. Since $ \abs{\alpha}_p \le 1 $, we have $ \abs{\beta}_p \le 1 $, so if $ \beta = r / s $ with $ \br{r, s} = 1 $, then $ p \nmid s $. So there exists $ \gamma \in \ZZ $ with $ \abs{\gamma - \beta}_p < 1 $, if and only if $ s\gamma - r \equiv 0 \mod p $, which has solutions because $ \br{s, p} = 1 $. There exists $ a_0 \in \cbr{0, \dots, p - 1} $ such that $ \abs{\gamma - a_0}_p < 1 $, so
$$ \abs{\alpha - a_0}_p \le \max\br{\abs{\alpha - \beta}_p, \abs{\beta - \gamma}_p, \abs{\gamma - a_0}_p} < 1. $$
Then $ \abs{\br{\alpha - a_0} / p}_p \le 1 $, that is $ \br{\alpha - a_0} / p \in \ZZ_p $. Repeating the argument, there exists $ a_1 \in \cbr{0, \dots, p - 1} $ such that $ \abs{\br{\alpha - a_0} / p - a_1}_p < 1 $, that is $ \br{\alpha - a_0 - a_1p} / p^2 \in \ZZ_p $. By induction, we find $ a_0, a_1, \dots $ such that $ \abs{\alpha - \br{a_0 + \dots + a_np^n}}_p \le p^{-\br{n + 1}} $. So $ \alpha = \sum_{n = 0}^\infty a_np^n $.
\end{enumerate}
\end{proof}

\begin{corollary}
Any element $ \alpha $ of $ \QQ_p $ can be uniquely written as
$$ \alpha = \sum_{n \ge -T} a_np^n, \qquad a_{-T} \ne 0, \qquad a_n \in \cbr{0, \dots, p - 1}. $$
\end{corollary}

\begin{proof}
If $ \abs{\alpha}_p = p^T $, then $ \abs{p^T\alpha}_p = 1 $, so $ p^T\alpha \in \ZZ_p $, and the claim follows from Proposition \ref{prop:2.21}.$ 2 $ applied to $ p^T\alpha $.
\end{proof}

\begin{corollary}
$ \ZZ $ is dense in $ \ZZ_p $.
\end{corollary}

\begin{proof}
If $ \alpha \in \ZZ_p $, write $ \alpha = \sum_n a_np^n $. Then
$$ \abs{\alpha - \br{a_0 + \dots + a_mp^m}} \le p^{-\br{m + 1}}, $$
and $ a_0 + \dots + a_mp^m \in \ZZ $.
\end{proof}

\pagebreak

For all $ m \ge 1 $, there is a surjective ring homomorphism
$$ \function{\ZZ_p}{\ZZ / p^m\ZZ}{\sum_{n = 0}^\infty a_np^n}{\sum_{n = 0}^{m - 1} a_np^n}. $$
In fact
$$ \ZZ_p / p^m\ZZ_p = \ZZ / p^m\ZZ, \qquad \ZZ_p = \varprojlim_m \ZZ / p^m\ZZ. $$

\begin{lemma}
\label{lem:2.24}
$$ \ZZ_p^\times = \cbr{x \in \ZZ_p \st \abs{x}_p = 1}. $$
\end{lemma}

\begin{proof}
If $ \abs{x}_p = 1 $ then $ x \ne 0 $, and so $ x^{-1} \in \QQ_p $, and $ \abs{x^{-1}}_p = 1 / \abs{x}_p = 1 $, so $ x^{-1} \in \ZZ_p $. Conversely if $ x \in \ZZ_p^\times $ then there exists $ y \in \ZZ_p $ such that $ xy = 1 $, so $ \abs{x}_p\abs{y}_p = 1 $. But $ \abs{x}_p, \abs{y}_p \le 1 $, so $ \abs{x}_p = \abs{y}_p = 1 $.
\end{proof}

Now $ \abr{p} \subset \ZZ_p $ is a maximal ideal, because $ \ZZ_p / \abr{p} = \ZZ / p\ZZ $ is a field. Since $ \ZZ_p^\times = \ZZ_p \setminus \abr{p} $ by Lemma \ref{lem:2.24}, $ \abr{p} $ is the unique maximal ideal of $ \ZZ_p $, that is $ \ZZ_p $ is a local ring. In fact it is a discrete valuation ring.

\begin{notation*}
A unit of $ \QQ_p $ is a unit in $ \ZZ_p $, that is an element of $ \abs{\cdot}_p = 1 $.
\end{notation*}

\begin{corollary}
Every element of $ \QQ_p $ other than zero is uniquely of the form $ p^nu $ for $ n \in \ZZ $ and $ u $ is a unit.
\end{corollary}

\begin{proof}
If $ \alpha \in \QQ_p $ and $ \alpha \ne 0 $, write $ \abs{\alpha}_p = p^{-n} $ for $ n \in \ZZ $, and set $ u = \alpha p^{-n} $.
\end{proof}

Hensel's lemma is Newton-Raphson in $ \QQ_p $. A reminder that if $ k $ is any field, and $ f\br{X} \in k\sbr{X} $, then we can define $ f'\br{X}, f''\br{X}, \dots $ formally by $ \tod{}{x}\br{X^n} = nX^{n - 1} $.

\begin{theorem}[Hensel's lemma]
Let $ k $ be a non-archimedean field with norm $ \abs{\cdot} $ and $ R = \cbr{x \in k \st \abs{x} \le 1} $. For example, $ k = \QQ_p $, $ \abs{\cdot} = \abs{\cdot}_p $, and $ R = \ZZ_p $. Suppose $ f \in R\sbr{X} $, and $ t_0 \in R $ such that $ \abs{f\br{t_0}} < \abs{f'\br{t_0}}^2 $. Then there exists a unique $ t \in R $ such that
$$ f\br{t} = 0, \qquad \abs{t - t_0} < \abs{f'\br{t_0}}. $$
Furthermore
$$ \abs{f'\br{t}} = \abs{f'\br{t_0}}, \qquad \abs{t - t_0} = \dfrac{\abs{f\br{t_0}}}{\abs{f'\br{t_0}}}. $$
\end{theorem}

\begin{proof}
Construct a Cauchy sequence $ t_0, t_1, \dots $ by
$$ t_{n + 1} = t_n - \dfrac{f\br{t_n}}{f'\br{t_n}}. $$
It turns out that $ \abs{f'\br{t_n}} = \abs{f'\br{t_0}} $, so
$$ \abs{\dfrac{f\br{t_n}}{f'\br{t_0}}} = \abs{\dfrac{f\br{t_n}}{f'\br{t_n}}} = \abs{t_{n + 1} - t_n} \to 0, $$
that is $ f\br{t_n} \to 0 $, that is $ f\br{t} = 0 $.
\end{proof}

\begin{lemma}
If $ f\br{X} \in R\sbr{X} $ has a simple root $ X = t \in R $, then for any $ t_0 \in k $ with $ \abs{t - t_0} < \abs{f'\br{t}} $, we have
$$ \abs{f'\br{t}} = \abs{f'\br{t_0}}, \qquad \abs{f\br{t_0}} < \abs{f'\br{t_0}}^2. $$
\end{lemma}

\begin{exercise}
The equation $ X^2 = 7 $ has a solution in $ \ZZ_3 $. Take $ f\br{X} = X^2 - 7 $. Then $ f'\br{X} = 2X $. So $ \abs{f'\br{X}}_3 = \abs{X}_3 $. So we need to find $ t_0 $ such that $ \abs{t_0^2 - 7}_3 < \abs{t_0}_3^2 $. For example, choose $ t_0 \in \ZZ $ such that $ 3 \nmid t_0 $ and $ t_0^2 \equiv 7 \mod 3 $, for example $ t_0 = 1 $. Hensel's lemma implies that there exists a unique $ t \in \ZZ_3 $ such that $ t^2 = 7 $ and $ \abs{t - 1}_3 < 1 $, that is $ t \equiv 1 \mod 3 $. In the same way, show that there exists a unique $ s \in \ZZ_3 $ such that $ s^2 = 7 $ and $ s \equiv 2 \mod 3 $. In fact $ s = -t $, since $ \br{-t}^2 = t^2 $ and $ X^2 - 7 = \br{X - t}\br{X + t} $.
\end{exercise}

\begin{corollary}
Let $ u \in \ZZ_p^\times $. If $ p > 2 $, then $ u $ is a square if and only if it is a square modulo $ p $. If $ p = 2 $, then $ u $ is a square if and only if it is a square modulo $ 8 $, if and only if $ u \equiv 1 \mod 8 $.
\end{corollary}

\begin{proof}
Exercise. \footnote{Exercise}
\end{proof}

\pagebreak

\section{Basic algebraic geometry}

\lecture{5}{Monday}{14/10/19}

An affine \textbf{algebraic curve} over $ k $ is an equation
$$ f\br{x, y} = 0, \qquad 0 \ne f \in k\sbr{x, y}. $$
The \textbf{degree} $ n = \deg f \in \NN_{> 0} $ of this curve is the total degree, so if $ f\br{x, y} = \sum_{i, j = 0}^n a_{ij}x^iy^j $, then
$$ \deg f = \max\cbr{i + j \st a_{ij} \ne 0}. $$
Algebraic curves of degree one are \textbf{lines}. Algebraic curves of degree two are \textbf{conics}. Two curves $ x = 0 $ and $ y = f\br{x} $ for $ f\br{x} \in k\sbr{x} $ have intersection points the zeroes of $ f\br{x} $, and a non-zero polynomial of degree $ n $ has $ n $ roots, but $ f\br{x} = x^2 + 1 $ has no real zeroes, so need to work over $ \CC $ or some algebraically closed field.

\begin{definition}
A field $ k $ is \textbf{algebraically closed} if any non-zero polynomial $ f\br{x} \in k\sbr{x} $ has a zero in $ k $.
\end{definition}

By induction on the degree,
$$ f\br{x} = a_n\prod_{j = 1}^n \br{x - \alpha_j}, \qquad a_n, \alpha_j \in k. $$
B\'ezout's theorem states that two algebraic curves of degree $ d_1 $ and $ d_2 $ respectively have $ d_1d_2 $ common points.
\begin{itemize}
\item We need to assume that $ k $ is algebraically closed. For example, the \textbf{fundamental theorem of algebra}, by Gauss, states that $ \CC $ is algebraically closed.
\item We need to count multiplicities. There is a definition given for multiplicity. For example, if $ \underline{0} = \br{0, 0} $ is the intersection point of two curves $ f\br{x, y} = 0 $ and $ g\br{x, y} = 0 $ for $ f, g \in \CC\sbr{x, y} $, so $ f\br{\underline{0}} = g\br{\underline{0}} = 0 $, then the \textbf{multiplicity} at $ \underline{0} $ is
$$ \dim_\CC \CC\sbr{\sbr{x, y}} / \abr{f, g} < \infty. $$
\item We need to enlarge the plane to contain points at infinity. For example, the \textbf{real projective plane}
$$ \PP^2\br{\RR} = \RR^2 \cup \cbr{\text{points at infinity}} $$
is the equivalence classes of affine lines through $ \RR^2 $ modulo parallelism, where if $ l_1, l_2 \in \RR^2 $, then $ l_1 $ is parallel to $ l_2 $ if and only if $ l_1 \cap l_2 = \emptyset $ or $ l_1 = l_2 $, which is an equivalence relation. There is an injection from points in $ \cbr{y = 1} $ to affine lines through $ \underline{0} $, and for any class of parallel affine lines on $ \cbr{y = 1} $ there exists a unique line going through $ \underline{0} $ and parallel to these lines, so
$$ \PP^2\br{\RR} = \cbr{\text{lines from} \ \cbr{y = 1}} \cup \cbr{\text{lines parallel to} \ \cbr{y = 1}}. $$
This collection of subsets are called \textbf{projective lines}, which are two-dimensional subspaces in $ \RR^3 $, and points are one-dimensional subspaces in $ \RR^3 $. The set of points at infinity is a projective line, and any affine line $ l \subset \RR^2 $ gives a projective line $ l^\# = l \cup \cbr{\text{parallelism class}} $. Thus any two different projective lines intersect in exactly one point, and this definition makes sense for any field.
\end{itemize}

The following is an equivalent description of $ \PP^2\br{k} $. Let $ k $ be any field. Then
$$ \PP^2\br{k} = k^3 \setminus \cbr{\underline{0}} / \sim $$
is the equivalence classes $ \br{x_0, x_1, x_2} $ such that $ x_i \in k $ are not all zero modulo $ \sim $, where $ \underline{x} \sim \underline{y} $ if and only if $ \underline{x} = \lambda \cdot \underline{y} $ for $ \lambda \in k \setminus \cbr{\underline{0}} = k^* $.

\begin{definition}
The \textbf{projective $ n $-space} is
$$ \PP^n\br{k} = k^{n + 1} \setminus \cbr{\underline{0}} / \sim. $$
\end{definition}

\begin{notation}
The \textbf{homogeneous coordinates} $ \sbr{x_0 : \dots : x_n} $ is an equivalence class of non-zero vectors in $ k^{n + 1} $ modulo $ \sim $, so
$$ \PP^n\br{k} = \cbr{\sbr{x_0 : \dots : x_n} \st x_i \in k \ \text{not all zero}}. $$
\end{notation}

\pagebreak

\begin{definition}
The \textbf{affine $ n $-space} is
$$ \AA^n\br{k} = k^n. $$
\end{definition}

\begin{lemma}
Let
$$ \function[\phi_i]{\AA^n\br{k}}{\PP^n\br{k}}{\br{x_0, \dots, x_{n - 1}}}{\sbr{x_0 : \dots : x_{i - 1} : 1 : x_{i + 1} : \dots : x_{n - 1}}}. $$
Then $ \phi_i $ is injective, and
$$ \PP^n\br{k} = \bigcup_{i = 0}^n \Im \phi_i. $$
\end{lemma}

\begin{proof}
Obvious.
\end{proof}

\begin{exercise}
There is an isomorphism
$$ \function{\PP^{n - 1}\br{k}}{\PP^n\br{k} \setminus \phi_n\br{\AA^n\br{k}}}{\sbr{x_0 : \dots : x_{n - 1}}}{\sbr{x_0 : \dots : x_{n - 1} : 0}}. $$
\end{exercise}

\begin{definition}
The \textbf{points at infinity} of $ \PP^n\br{k} $ are the ones not in $ \phi_n\br{\AA^n\br{k}} $. They are recognisable as the graph of $ X_n = 0 $.
\end{definition}

\end{document}